<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Estimate DFM with Maximum Likelihood — estimate_ml • rjd3nowcasting</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Estimate DFM with Maximum Likelihood — estimate_ml"><meta name="description" content="Estimate DFM with Maximum Likelihood"><meta property="og:description" content="Estimate DFM with Maximum Likelihood"><meta property="og:image" content="https://rjdverse.github.io/rjd3nowcasting/logo.svg"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">rjd3nowcasting</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.0.3</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/rjd3nowcasting.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/rjdverse/rjd3nowcasting/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.svg" class="logo" alt=""><h1>Estimate DFM with Maximum Likelihood</h1>
      <small class="dont-index">Source: <a href="https://github.com/rjdverse/rjd3nowcasting/blob/v2.0.3/R/estimation.R" class="external-link"><code>R/estimation.R</code></a></small>
      <div class="d-none name"><code>estimate_ml.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Estimate DFM with Maximum Likelihood</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">estimate_ml</span><span class="op">(</span></span>
<span>  <span class="va">dfm</span>,</span>
<span>  <span class="va">data</span>,</span>
<span>  standardized <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  input_standardization <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  pca_init <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  em_init <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  em_max_iter <span class="op">=</span> <span class="fl">100</span>,</span>
<span>  em_eps <span class="op">=</span> <span class="fl">1e-09</span>,</span>
<span>  max_iter <span class="op">=</span> <span class="fl">1000</span>,</span>
<span>  max_block_iter <span class="op">=</span> <span class="fl">5</span>,</span>
<span>  simpl_model_iter <span class="op">=</span> <span class="fl">15</span>,</span>
<span>  independent_var_shocks <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  mixedEstimation <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  eps <span class="op">=</span> <span class="fl">1e-09</span>,</span>
<span>  re_estimate <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-dfm">dfm<a class="anchor" aria-label="anchor" href="#arg-dfm"></a></dt>
<dd><p>an object of class 'JD3_DfmModel'. Typically generated by the
create_model() function.</p></dd>


<dt id="arg-data">data<a class="anchor" aria-label="anchor" href="#arg-data"></a></dt>
<dd><p>an mts object.</p></dd>


<dt id="arg-standardized">standardized<a class="anchor" aria-label="anchor" href="#arg-standardized"></a></dt>
<dd><p>Boolean. Indicate whether the input series were already
standardized or not. Default is FALSE, meaning that a standardization of
the series will be preliminary applied as part of the process.</p></dd>


<dt id="arg-input-standardization">input_standardization<a class="anchor" aria-label="anchor" href="#arg-input-standardization"></a></dt>
<dd><p>Matrix. Mean and standard deviation of the
variables to consider for the pre-processing step of standardization.
Default is NULL, meaning that they will be re-calculated based on the data.
Typically, it can be filled with the output of the function
`get_results()$preprocessing$sample_mean_stdev` applied on a
previous estimate of the model. If provided manually, it must be a two
columns matrix with the mean in the first column and the standard deviation
in the second column. In the rows, the order of the variables should also
be respected (similar to the data). Note that this argument must be filled
if the re_estimate argument is set to FALSE. On the other hand, it is
ignored if the standardized argument is set to TRUE.</p></dd>


<dt id="arg-pca-init">pca_init<a class="anchor" aria-label="anchor" href="#arg-pca-init"></a></dt>
<dd><p>Boolean. Indicate whether a principal components analysis is
performed beforehand and used as initial condition for either the EM
algorithm (if em_init=TRUE) or directly for the ML estimation.</p></dd>


<dt id="arg-em-init">em_init<a class="anchor" aria-label="anchor" href="#arg-em-init"></a></dt>
<dd><p>Boolean. Indicate whether the EM algorithm is performed
beforehand and used as initial condition for the ML estimation.</p></dd>


<dt id="arg-em-max-iter">em_max_iter<a class="anchor" aria-label="anchor" href="#arg-em-max-iter"></a></dt>
<dd><p>Integer. Maximum number of iterations of the EM algorithm.
Ignored if em_init = FALSE.</p></dd>


<dt id="arg-em-eps">em_eps<a class="anchor" aria-label="anchor" href="#arg-em-eps"></a></dt>
<dd><p>Numeric. EM algorithm is run until the percentage likelihood
does not increase by more than the eps value (1e-9 is the default) or until
the maximum number of iterations is hit. Ignored if em_init = FALSE.</p></dd>


<dt id="arg-max-iter">max_iter<a class="anchor" aria-label="anchor" href="#arg-max-iter"></a></dt>
<dd><p>Integer. Maximum number of iterations for the ML estimation.</p></dd>


<dt id="arg-max-block-iter">max_block_iter<a class="anchor" aria-label="anchor" href="#arg-max-block-iter"></a></dt>
<dd><p>Integer. Maximum number of iterations in optimization
by block. The model parameters are divided in two blocks: one related to
the measurement equations and one to the VAR equations. While the EM
algorithm requires one iteration per block, the numerical optimization
allows us to set the number of iterations desired per block.</p></dd>


<dt id="arg-simpl-model-iter">simpl_model_iter<a class="anchor" aria-label="anchor" href="#arg-simpl-model-iter"></a></dt>
<dd><p>Integer. Number of simplified model iterations
allowed.</p></dd>


<dt id="arg-independent-var-shocks">independent_var_shocks<a class="anchor" aria-label="anchor" href="#arg-independent-var-shocks"></a></dt>
<dd><p>Boolean. Whether we assume that shocks in the
VAR block are independent.</p></dd>


<dt id="arg-mixedestimation">mixedEstimation<a class="anchor" aria-label="anchor" href="#arg-mixedestimation"></a></dt>
<dd><p>Boolean. The mixed estimation option alternates
between the iterations for the VAR block alone and simultaneous iterations
for the two blocks.</p></dd>


<dt id="arg-eps">eps<a class="anchor" aria-label="anchor" href="#arg-eps"></a></dt>
<dd><p>Numeric. ML estimation is run until the percentage likelihood does
not increase by more than the eps value (1e-9 is the default) or until the
maximum number of iterations is hit.</p></dd>


<dt id="arg-re-estimate">re_estimate<a class="anchor" aria-label="anchor" href="#arg-re-estimate"></a></dt>
<dd><p>Boolean. Indicate whether the model will be re-estimated
or not. Default is TRUE. Could be set to FALSE if, for some reasons during
the production process, we wanted to freeze to model for some periods of
time. It is not recommended to freeze the model for a long period.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>an object of class 'JD3_DfmEstimates'</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">100</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">data</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/stats/ts.html" class="external-link">ts</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">500</span><span class="op">)</span>, <span class="fl">100</span>, <span class="fl">5</span><span class="op">)</span>, frequency <span class="op">=</span> <span class="fl">12</span>, start <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2010</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">data</span><span class="op">[</span><span class="fl">100</span>,<span class="fl">1</span><span class="op">]</span><span class="op">&lt;-</span><span class="va">data</span><span class="op">[</span><span class="fl">99</span><span class="op">:</span><span class="fl">100</span>,<span class="fl">2</span><span class="op">]</span><span class="op">&lt;-</span><span class="va">data</span><span class="op">[</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">100</span><span class="op">)</span><span class="op">[</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">100</span>,<span class="fl">3</span><span class="op">)</span><span class="op">]</span>,<span class="fl">5</span><span class="op">]</span><span class="op">&lt;-</span><span class="cn">NA</span></span></span>
<span class="r-in"><span><span class="va">dfm</span> <span class="op">&lt;-</span> <span class="fu"><a href="create_model.html">create_model</a></span><span class="op">(</span>nfactors<span class="op">=</span><span class="fl">2</span>,</span></span>
<span class="r-in"><span>                    nlags<span class="op">=</span><span class="fl">2</span>,</span></span>
<span class="r-in"><span>                    factors_type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"M"</span>, <span class="st">"M"</span>, <span class="st">"YoY"</span>, <span class="st">"M"</span>, <span class="st">"Q"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                    factors_loading <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span>data<span class="op">=</span><span class="cn">TRUE</span>, <span class="fl">5</span>, <span class="fl">2</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                    var_init <span class="op">=</span> <span class="st">"Unconditional"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">est_ml</span><span class="op">&lt;-</span><span class="fu">estimate_ml</span><span class="op">(</span><span class="va">dfm</span>, <span class="va">data</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#est_ml&lt;-estimate_ml(dfm, data, re_estimate=FALSE) # model not re-estimated</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Corentin Lemasson.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer></div>





  </body></html>

